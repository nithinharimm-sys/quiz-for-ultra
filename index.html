<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ECE Ultra // Smash Sound</title>
    <style>
        :root {
            --primary: #00f2fe;
            --accent: #7000ff;
            --bg: #010103;
            --success: #00ff9d;
            --error: #ff003c;
        }

        * { box-sizing: border-box; font-family: 'Inter', sans-serif; cursor: crosshair; }
        body { margin: 0; background: var(--bg); color: #fff; min-height: 100vh; display: flex; justify-content: center; align-items: center; overflow: hidden; perspective: 1200px; }

        /* SHATTER VISUAL GLITCH */
        @keyframes smash-hit-glitch {
            0% { transform: translate(0) scale(1); filter: brightness(1) contrast(1); }
            5% { transform: translate(-25px, 15px); filter: brightness(5) contrast(3); }
            15% { transform: translate(25px, -15px) rotate(2deg); filter: hue-rotate(180deg); }
            100% { transform: translate(0) scale(1); filter: brightness(1); }
        }
        .shatter-active { animation: smash-hit-glitch 0.5s cubic-bezier(0.1, 0.9, 0.2, 1); }

        #bg-canvas { position: fixed; top: 0; left: 0; z-index: -1; }
        
        .quiz-card {
            background: rgba(255, 255, 255, 0.03);
            backdrop-filter: blur(50px) saturate(200%);
            border: 1px solid rgba(255,255,255,0.1);
            border-radius: 40px; padding: 40px; width: 95%; max-width: 480px;
            box-shadow: 0 40px 100px rgba(0,0,0,0.8);
            transform-style: preserve-3d; transition: transform 0.1s ease-out;
        }

        .option {
            background: rgba(255,255,255,0.03); padding: 18px; margin-bottom: 12px;
            border-radius: 18px; border: 1px solid rgba(255,255,255,0.05);
            transition: 0.2s; font-weight: 600;
        }
        .option:hover { background: rgba(255,255,255,0.08); border-color: var(--primary); transform: translateX(10px); }
        .correct { background: var(--success) !important; color: #000; box-shadow: 0 0 30px var(--success); }
        .wrong { background: var(--error) !important; color: #fff; box-shadow: 0 0 50px var(--error); border: none !important; }

        #timer-bar { height: 3px; background: var(--primary); width: 100%; box-shadow: 0 0 10px var(--primary); margin: 25px 0; }
        .btn-main { width: 100%; padding: 20px; border-radius: 18px; border: none; background: #fff; color: #000; font-weight: 900; text-transform: uppercase; letter-spacing: 2px; transition: 0.3s; }
        .btn-main:hover { background: var(--primary); box-shadow: 0 0 30px var(--primary); }
    </style>
</head>
<body id="view">

<canvas id="bg-canvas"></canvas>

<div class="quiz-card" id="main-card">
    <div id="start-screen" style="text-align:center;">
        <h1 style="font-size: 2.8rem; letter-spacing: -2px; margin:0;">ECE<span style="color:var(--primary)">.PRO</span></h1>
        <p style="opacity:0.4; margin-bottom:40px; letter-spacing:3px;">ACOUSTIC IMPACT LOADED</p>
        <button class="btn-main" onclick="initQuiz()">Boot Interface</button>
    </div>

    <div id="quiz-screen" style="display:none;">
        <div style="display:flex; justify-content:space-between; font-size:0.75rem; opacity:0.6; font-weight:800; letter-spacing:1px;">
            <span>OPERATOR_ACTIVE</span>
            <span id="display-score">0000 PTS</span>
        </div>
        <div id="timer-bar"></div>
        <h2 id="question-text" style="min-height:90px; font-size:1.4rem; line-height:1.2;"></h2>
        <div id="options-container"></div>
        <button id="next-btn" class="btn-main" style="display:none; margin-top:20px;" onclick="handleNext()">Next Node</button>
    </div>

    <div id="result-screen" style="display:none; text-align:center;">
        <h3 style="opacity:0.5; letter-spacing:5px;">EVALUATION_COMPLETE</h3>
        <h1 id="final-pts" style="font-size:6rem; margin:10px 0;">0</h1>
        <div id="rank-text" style="font-size:2.2rem; font-weight:900; margin-bottom:40px;">---</div>
        <button class="btn-main" onclick="location.reload()">Retry Test</button>
    </div>
</div>

<script>
const audioCtx = new (window.AudioContext || window.webkitAudioContext)();

function playShatter() {
    const now = audioCtx.currentTime;

    // LAYER 1: The Heavy Impact (Low frequency thud)
    const thud = audioCtx.createOscillator();
    const thudG = audioCtx.createGain();
    thud.type = 'triangle';
    thud.frequency.setValueAtTime(150, now);
    thud.frequency.exponentialRampToValueAtTime(40, now + 0.2);
    thudG.gain.setValueAtTime(0.6, now);
    thudG.gain.linearRampToValueAtTime(0, now + 0.3);
    thud.connect(thudG); thudG.connect(audioCtx.destination);
    thud.start(); thud.stop(now + 0.3);

    // LAYER 2: The Glass Crunch (Filtered White Noise)
    const bufferSize = audioCtx.sampleRate * 0.5;
    const buffer = audioCtx.createBuffer(1, bufferSize, audioCtx.sampleRate);
    const data = buffer.getChannelData(0);
    for (let i = 0; i < bufferSize; i++) { data[i] = Math.random() * 2 - 1; }
    const noise = audioCtx.createBufferSource();
    noise.buffer = buffer;
    const filter = audioCtx.createBiquadFilter();
    filter.type = 'highpass';
    filter.frequency.setValueAtTime(3000, now); // Cutting out the bass for a glassy sound
    const noiseG = audioCtx.createGain();
    noiseG.gain.setValueAtTime(0.5, now);
    noiseG.gain.exponentialRampToValueAtTime(0.01, now + 0.4);
    noise.connect(filter); filter.connect(noiseG); noiseG.connect(audioCtx.destination);
    noise.start();

    // LAYER 3: The Falling Shards (High-freq metallic tinks)
    for(let i=0; i<8; i++) {
        const shard = audioCtx.createOscillator();
        const shardG = audioCtx.createGain();
        shard.type = 'sine';
        // Random high frequencies for a chaotic feel
        shard.frequency.setValueAtTime(4000 + Math.random() * 6000, now + (i * 0.03));
        shardG.gain.setValueAtTime(0.2, now + (i * 0.03));
        shardG.gain.exponentialRampToValueAtTime(0.001, now + (i * 0.03) + 0.1);
        shard.connect(shardG); shardG.connect(audioCtx.destination);
        shard.start(now + (i * 0.03)); shard.stop(now + (i * 0.03) + 0.2);
    }
}

function playSuccess() {
    const now = audioCtx.currentTime;
    [523.25, 783.99, 1046.50].forEach((f, i) => {
        const osc = audioCtx.createOscillator();
        const g = audioCtx.createGain();
        osc.frequency.setValueAtTime(f, now + (i*0.05));
        g.gain.setValueAtTime(0.1, now);
        g.gain.exponentialRampToValueAtTime(0.001, now + 0.6);
        osc.connect(g); g.connect(audioCtx.destination);
        osc.start(); osc.stop(now + 0.6);
    });
}

// Background Animation
const canvas = document.getElementById('bg-canvas');
const ctx = canvas.getContext('2d');
let stars = [], speed = 1.2;
function resize() { canvas.width = window.innerWidth; canvas.height = window.innerHeight; }
window.addEventListener('resize', resize); resize();
for(let i=0; i<200; i++) stars.push({ x: Math.random()*canvas.width, y: Math.random()*canvas.height, z: Math.random()*canvas.width });

function animate() {
    ctx.fillStyle = "rgba(1, 1, 3, 0.25)"; ctx.fillRect(0,0,canvas.width,canvas.height);
    stars.forEach(s => {
        s.z -= speed;
        if(s.z <= 0) s.z = canvas.width;
        let sx = (s.x - canvas.width/2) * (canvas.width/s.z) + canvas.width/2;
        let sy = (s.y - canvas.height/2) * (canvas.width/s.z) + canvas.height/2;
        ctx.fillStyle = speed > 10 ? "var(--primary)" : "white";
        ctx.beginPath(); ctx.arc(sx, sy, (1-s.z/canvas.width)*3.5, 0, Math.PI*2); ctx.fill();
    });
    requestAnimationFrame(animate);
}
animate();

// 3D Tilt
document.addEventListener('mousemove', (e) => {
    const card = document.getElementById('main-card');
    let x = (window.innerWidth / 2 - e.pageX) / 35;
    let y = (window.innerHeight / 2 - e.pageY) / 35;
    card.style.transform = `rotateY(${-x}deg) rotateX(${y}deg)`;
});

// Questions List
const questions = [
    {q:"Expansion for ECE?", o:["Electrical Engineering","Electronics and Communication Engineering","Electronic Control","Engineering Electronics"], a:1},
    {q:"Component storing energy in a magnetic field?", o:["Resistor","Capacitor","Inductor","Diode"], a:2},
    {q:"Standard AC mains frequency in India?", o:["60 Hz","50 Hz","100 Hz","120 Hz"], a:1},
    {q:"IoT stands for:", o:["Input Output Tech","Internet of Things","Internal Objects","Internet of Tech"], a:1},
    {q:"Which component acts as a solid-state switch?", o:["Capacitor","Transistor","Inductor","Transformer"], a:1},
    {q:"The unit of electrical resistance is:", o:["Volt","Ohm","Ampere","Watt"], a:1},
    {q:"Full form of LED:", o:["Light Energy Diode","Light Emitting Diode","Low Emitting Diode","Light Electronic"], a:1},
    {q:"Base of Binary number system?", o:["10","8","2","16"], a:2},
    {q:"Ohm's Law is defined as:", o:["V=I/R","V=I-R","V=I*R","V=I+P"], a:2},
    {q:"Gate outputting HIGH only if both inputs are HIGH?", o:["OR","XOR","AND","NAND"], a:2}
];

let score=0, qIdx=0, timer, timeLeft=100, answered=false;

function initQuiz() {
    if (audioCtx.state === 'suspended') audioCtx.resume();
    document.getElementById('start-screen').style.display='none';
    document.getElementById('quiz-screen').style.display='block';
    loadQuestion();
}

function loadQuestion() {
    answered = false;
    const q = questions[qIdx];
    document.getElementById('next-btn').style.display = 'none';
    document.getElementById('question-text').innerText = q.q;
    const container = document.getElementById('options-container');
    container.innerHTML = '';
    q.o.forEach((opt, i) => {
        const div = document.createElement('div');
        div.className = 'option';
        div.innerText = opt;
        div.onclick = () => checkAns(i, div);
        container.appendChild(div);
    });
    timeLeft = 100;
    clearInterval(timer);
    timer = setInterval(() => {
        timeLeft -= 1.8;
        document.getElementById('timer-bar').style.width = timeLeft + "%";
        if(timeLeft <= 0) handleImpact(false);
    }, 100);
}

function checkAns(idx, el) {
    if(answered) return;
    answered = true; clearInterval(timer);
    handleImpact(idx === questions[qIdx].a, el);
}

function handleImpact(isCorrect, el) {
    const card = document.getElementById('main-card');
    const view = document.getElementById('view');

    if(isCorrect) {
        score += Math.floor(100 + timeLeft);
        el.classList.add('correct');
        playSuccess();
        speed = 25; setTimeout(() => speed = 1.2, 550);
    } else {
        if(el) el.classList.add('wrong');
        document.querySelectorAll('.option')[questions[qIdx].a].classList.add('correct');
        playShatter();
        view.classList.add('shatter-active');
        setTimeout(() => view.classList.remove('shatter-active'), 500);
    }
    document.getElementById('display-score').innerText = `${score.toString().padStart(4, '0')} PTS`;
    document.getElementById('next-btn').style.display = 'block';
}

function handleNext() {
    qIdx++;
    if(qIdx < questions.length) loadQuestion();
    else showResult();
}

function showResult() {
    document.getElementById('quiz-screen').style.display = 'none';
    document.getElementById('result-screen').style.display = 'block';
    document.getElementById('final-pts').innerText = score;
    const rankEl = document.getElementById('rank-text');
    
    if (score >= 1800) { rankEl.innerText = "OUTSTANDING"; rankEl.style.color = "var(--primary)"; }
    else if (score >= 1300) { rankEl.innerText = "EXCELLENT"; rankEl.style.color = "var(--success)"; }
    else if (score >= 800) { rankEl.innerText = "GOOD"; rankEl.style.color = "var(--accent)"; }
    else { rankEl.innerText = "POOR"; rankEl.style.color = "var(--error)"; }
}
</script>
</body>
</html>
